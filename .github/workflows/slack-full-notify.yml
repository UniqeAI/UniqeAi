name: Slack Full Notifications

on:
  push:
    branches: ["**"]     # Her push
  create:                # Branch veya tag oluşturulduğunda
  pull_request:          # PR açıldığında, güncellendiğinde vs.
    types: [opened, reopened, closed, edited, synchronize]
  issues:
    types: [opened, closed, reopened, edited]
  issue_comment:
    types: [created, edited]
  pull_request_review:
    types: [submitted, edited, dismissed]
  discussion:
    types: [created, edited, answered, deleted]
  discussion_comment:
    types: [created, edited, deleted]
  workflow_run:
    types: [completed]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Prepare and Send Slack Message
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          EVENT_NAME: ${{ github.event_name }}
          ACTOR: ${{ github.actor }}
          REPO: ${{ github.repository }}
          REF: ${{ github.ref }}
        run: |
          EVENT_TYPE=$EVENT_NAME
          BRANCH_NAME="${REF##*/}"
          TEXT=""

          case "$EVENT_TYPE" in
            push)
              COMMIT_MSG="${{ github.event.head_commit.message }}"
              TEXT=":inbox_tray: *${ACTOR}*, \`${BRANCH_NAME}\` branch'ine commit attı. Mesaj:\n> $COMMIT_MSG"
              ;;
            create)
              TEXT=":seedling: *${ACTOR}*, \`${BRANCH_NAME}\` adında yeni bir branch/tag oluşturdu."
              ;;
            pull_request)
              PR_TITLE="${{ github.event.pull_request.title }}"
              TEXT=":twisted_rightwards_arrows: *${ACTOR}*, bir Pull Request oluşturdu veya güncelledi: *$PR_TITLE*"
              ;;
            issues)
              ISSUE_TITLE="${{ github.event.issue.title }}"
              TEXT=":exclamation: *${ACTOR}*, yeni bir Issue açtı veya düzenledi: *$ISSUE_TITLE*"
              ;;
            issue_comment)
              COMMENT_BODY="${{ github.event.comment.body }}"
              TEXT=":speech_balloon: *${ACTOR}*, bir Issue'a yorum yaptı:\n> $COMMENT_BODY"
              ;;
            pull_request_review)
              TEXT=":mag_right: *${ACTOR}*, bir Pull Request'i inceledi."
              ;;
            discussion)
              DISCUSSION_TITLE="${{ github.event.discussion.title }}"
              TEXT=":speaking_head: *${ACTOR}*, bir Discussion oluşturdu/düzenledi: *$DISCUSSION_TITLE*"
              ;;
            discussion_comment)
              COMMENT_BODY="${{ github.event.comment.body }}"
              TEXT=":left_speech_bubble: *${ACTOR}*, bir Discussion'a yorum yaptı:\n> $COMMENT_BODY"
              ;;
            workflow_run)
              STATUS="${{ github.event.workflow_run.conclusion }}"
              TEXT=":gear: Workflow \`${REPO}\` için çalıştırıldı. Durum: *$STATUS*"
              ;;
            *)
              TEXT=":grey_question: *${ACTOR}* bir olay gerçekleştirdi: $EVENT_TYPE"
              ;;
          esac

          curl -X POST -H 'Content-type: application/json' \
            --data "{\"text\":\"$TEXT\"}" \
            "$SLACK_WEBHOOK_URL"
